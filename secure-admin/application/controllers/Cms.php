<?php defined('BASEPATH') OR exit('No direct script access allowed');class Cms extends CI_Controller{    function __construct()    {        parent::__construct();        $this->load->model("cms_model");        $this->load->library('form_validation');        $this->load->library('session');        $this->load->helper(array('form', 'url'));//        if($this->session->userdata('user_id') == NULL){//            redirect('account','refresh');//        }    }    public function index()    {        $this->cmsview();    }    public function cmsview()	{        $this->data['Module']='Page';        $this->data['action']='view';        $this->data['ViewCms']=$this->cms_model->get_cmspage_info();        $this->load->view("templates/header",$this->data);        $this->load->view("cms/cms-view",$this->data);        $this->load->view("templates/footer");    }    public function cmsedit($id)    {        $this->data['Module']='Page';        $this->data['action']='edit';        $this->data['editcmsdata']=$this->cms_model->get_cmspagewise_info($id);        $this->load->view("templates/header",$this->data);        $this->load->view("cms/cms-edit",$this->data);        $this->load->view("templates/footer");        if($this->input->post('cmsupdate')){            $this->form_validation->set_rules('cms_title', 'Page title', 'required');            $this->form_validation->set_rules('cms_metatitle', 'Page metatitle', 'required');            $this->form_validation->set_rules('cms_content', 'CMS page content', 'required|trim|min_length[1]');            //$this->form_validation->set_rules('slugname', 'slugname', 'required');            if ($this->form_validation->run() == TRUE)            {                $cmsUpdate = array(                    'page_title'         => $this->input->post('cms_title'),                    'page_metatitle'     => $this->input->post('cms_metatitle'),                    'page_metadesc'      => $this->input->post('metadescription'),                    'page_metakeyword'   => $this->input->post('metakeywords'),                    'page_content'       => $this->input->post('cms_content'),                    'page_modified_date' => date("Y-m-d H:i:s")                );                $cmsUpdate['slug_name'] = preg_replace('/[^A-Za-z0-9-]+/', '_', strtolower($cmsUpdate['page_title']));                $cmspageid=$this->input->post('cmsid');                $data1['cmsUpdate'] = $this->cms_model->update_cms_info($cmspageid,$cmsUpdate);                $this->session->set_flashdata('success', 'Page details has been updated successfully.');                //redirect('cms/cmsview','refresh');                redirect('cms','refresh');            }            else            {                $cmspageerr = array (                    'page_title' => $this->input->post('cms_title'),                    'page_metatitle' => $this->input->post('cms_metatitle'),                    'page_metadesc' => $this->input->post('metadescription'),                    'page_metakeyword' => $this->input->post('metakeywords'),                    'page_content' => $this->input->post('cms_content'),                    'page_modified_date' => date("Y-m-d H:i:s")                );                $cmspageupdate = $this->input->post();                $cmspageupdate = $cmspageerr;                $this->data['validation_errors'] = validation_errors();                $this->session->set_flashdata('error', validation_errors() );                redirect('cms/cmsedit/' . $this->input->post('cmsid'));            }        }    }}